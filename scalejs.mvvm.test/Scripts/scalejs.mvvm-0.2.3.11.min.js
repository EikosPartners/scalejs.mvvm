//knockout-classBindingProvider v0.4.0 | (c) 2012 Ryan Niemeyer | http://www.opensource.org/licenses/mit-license

define("scalejs.mvvm/classBindingProvider",["knockout"],function(e){return function(n){function a(e,t){var n,r;return t[e]?t[e]:(n=e.split("."),r=n.reduce(function(e,t){return e[t]},t),r)}function f(t){e.utils.extend(i,t)}function l(e){var t,i;return e.nodeType===1?t=e.getAttribute(o):e.nodeType===8&&(i=(e.nodeValue||e.text||"").toString(),t=i.indexOf(u)>-1),!t&&n.fallback&&(t=r.nodeHasBindings(e)),t}function c(t,a){var f,l,c,h={},p,d,v="";t.nodeType===1?v=t.getAttribute(o):t.nodeType===8&&(p=(t.nodeValue||t.text||"").toString(),d=p.indexOf(u),d>-1&&(v=p.substring(d+u.length))),v?(v=v.replace(/^(\s|\u00A0)+|(\s|\u00A0)+$/g,"").replace(/(\s|\u00A0){2,}/g," ").split(" "),v.forEach(function(t){f=s(t,i),f&&(l=typeof f=="function"?f.call(a.$data,a,v):f,e.utils.extend(h,l))})):n.fallback&&(h=r.getBindings(t,a));for(c in h)h.hasOwnProperty(c)&&c!=="_ko_property_writers"&&!e.bindingHandlers[c]&&n.log&&(l?n.log('Unknown binding handler "'+c+'" found in',t,'defined in data-class "'+v+'" as',l,"Make sure that binding handler's name spelled correctly and that it's properly registered. The binding will be ignored."):n.log('Unknown binding handler "'+c+'" in',t,"Make sure that it's name spelled correctly and that it's properly registered. The binding will be ignored."));return h}var r=new e.bindingProvider,i={},s,o,u;return n=n||{},o=n.attribute||"data-class",u="ko "+(n.virtualAttribute||"class")+":",s=n.bindingRouter||a,{registerBindings:f,getBindings:c,nodeHasBindings:l}}}),define("scalejs.mvvm/htmlTemplateSource",["knockout","scalejs!core"],function(e,t){function o(e){var t=document.createElement("div");t.innerHTML=e,n(t.childNodes).forEach(function(e){e.nodeType===1&&r(e,"id")&&(s[e.id]=e.innerHTML)})}function u(e){function t(t,n){r(s.data,e)||(s.data[e]={});if(arguments.length===1)return s.data[e][t];s.data[e][t]=n}function n(t){if(arguments.length===0)return s[e];throw new Error('An attempt to override template "'+e+'" with content "'+t+'" '+"Template overriding is not supported.")}return{data:t,text:n}}var n=t.array.toArray,r=t.object.has,i=new e.nativeTemplateEngine,s={data:{}};return i.makeTemplateSource=u,e.setTemplateEngine(i),{registerTemplates:o}}),define("scalejs.mvvm/selectableArray",["knockout","scalejs!core"],function(e,t){var n=e.isObservable,r=e.utils.unwrapObservable,i=e.observable,s=e.computed,o=t.object.has,u=t.array;return function(t,a){function c(e){if(n(e.isSelected)&&(!o(a.isSelectedPath)||a.isSelectedPath==="isSelected"))return;if(n(e.isSelected))throw new Error('item has observable `isSelected` property but `isSelectedPath` specified as "'+a.isSelectedPath+'". `selectable` uses `isSelected` property of an item '+"to determine whether it's selected. Either don't specify `isSelectedPath` or "+"rename `isSelected` property to something else.");if(e.hasOwnProperty("isSelected"))throw new Error("item has non-observable `isSelected` property. `selectable` uses `isSelected` property of an item to determine whether it's selected. Either make `isSelected` observable or rename it.");e.isSelected=i();if(o(a.isSelectedPath)&&a.isSelectedPath!=="isSelected"&&!n(e[a.isSelectedPath]))throw new Error("item's property \""+a.isSelectedPath+'" specified by `isSelectedPath` '+" isn't observable. Either make it observable or specify different property in "+" `isSelectedPath`");o(a.isSelectedPath)&&(e.isSelected=e[a.isSelectedPath]),e.isSelected.subscribe(function(t){t?f(e):f()===e&&f(undefined)})}a=a||{};var f=a.selectedItem||i(),l;return n(t)?l=s(function(){var e=r(t);return e.forEach(c),u.copy(e)}):(t.forEach(c),l=u.copy(t)),f.subscribe(function(e){r(l).forEach(function(t){t.isSelected(t===e)})}),l.selectedItem=f,l}}),define("scalejs.mvvm/mvvm",["knockout","knockout.mapping","scalejs!core","./classBindingProvider","./htmlTemplateSource","./selectableArray"],function(e,t,n,r,i,s){function c(t){return e.observable(t)}function h(t){return e.observableArray(t)}function p(t){return e.computed(t)}function d(e){return t.toJSON(e)}function v(e){f.registerBindings(e)}function m(e,n,r){var i=Object.keys(r).reduce(function(e,t){return o(e,{k:t,create:function(e){return r[t](e.data)}})},{});return t.fromJS(e,i,n)}function g(){u(arguments).forEach(i.registerTemplates)}function y(e,t){return o(t,{template:e})}function b(){var t=document.getElementsByTagName("body")[0];t.innerHTML="<!-- ko class: scalejs-shell --><!-- /ko -->",v({"scalejs-shell":function(e){return{render:e.$data}}}),e.applyBindings(l)}var o=n.object.merge,u=n.array.toArray,a=n.functional.curry,f=r({log:n.log.warn,fallback:!0}),l=e.observable();return e.bindingProvider.instance=f,{core:{mvvm:{toJson:d,registerBindings:v,registerTemplates:g}},sandbox:{mvvm:{observable:c,observableArray:h,computed:p,registerBindings:v,registerTemplates:g,toJson:d,toViewModel:m,renderable:a(y),selectableArray:s,root:l}},init:b}}),define("scalejs.bindings/change",["knockout","scalejs!core"],function(e,t){function i(t,i,s,o){function d(e){return function(n){n!==h&&(h=n,e.call(o,n,t))}}if(!r(o))return;var u=e.utils.unwrapObservable,a=i(),f=u(a),l,c,h,p;for(l in f)f.hasOwnProperty(l)&&(c=f[l],n(c.initial,"function")&&c.initial.apply(o,[u(o[l]),t]),n(c.update,"function")&&(p=d(c.update)),n(c,"function")&&(p=d(c)),p&&o[l].subscribe(p))}var n=t.type.is,r=t.object.has;return{init:i}}),define("scalejs.bindings/render",["knockout","scalejs!core"],function(e,t){function s(e){return function(){function o(e){return e.template}var t=e(),s=i(t);return n(s,"array")||!r(s)?{name:o,foreach:s}:{name:s.template,data:s}}}function o(){return{controlsDescendantBindings:!0}}function u(t,n,r,i,o){return e.bindingHandlers.template.update(t,s(n),r,i,o)}var n=t.type.is,r=t.object.has,i=e.utils.unwrapObservable;return{init:o,update:u}}),define("scalejs.mvvm",["scalejs!core","knockout","./scalejs.mvvm/mvvm","./scalejs.bindings/change","./scalejs.bindings/render"],function(e,t,n,r,i){t.bindingHandlers.change=r,t.bindingHandlers.render=i,t.virtualElements.allowedBindings.change=!0,t.virtualElements.allowedBindings.render=!0,n.init(),e.registerExtension(n)});